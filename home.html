<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Photos of Sal3m</title>
  <link rel="icon" href="logo1.png">
  <style>
    :root{--bg: rgb(0,55,255); --panel:#ffffff; --accent:#4caf50}
    *{box-sizing:border-box}
    body{
      margin:0; min-height:100vh; background:var(--bg); font-family:system-ui,Segoe UI,Roboto,Arial; color:#111
    }
    .center{display:flex;flex-direction:column;align-items:center;padding-top:60px}
    .logo{width:200px;height:200px;border-radius:50%;object-fit:cover}
    .label{background:aqua;border-radius:18px;padding:10px 18px;margin-top:12px;font-size:18px}

    /* photo area */
    .photo-container{display:flex;flex-wrap:wrap;justify-content:center;gap:18px;padding:30px}
    .photo-wrapper{position:relative;display:inline-block}
    .photo-wrapper img{display:block;width:80vw;max-width:420px;border-radius:14px;box-shadow:0 8px 20px rgba(0,0,0,0.25)}

    /* buttons that appear on hover */
    .photo-btns{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;gap:10px;pointer-events:none}
    .photo-btns .btn{pointer-events:auto;background:rgba(255,255,255,0.95);border:none;padding:8px 12px;border-radius:10px;cursor:pointer;box-shadow:0 6px 18px rgba(0,0,0,0.2);font-size:15px}
    .photo-btns{opacity:0;transition:opacity .18s ease}
    .photo-wrapper:hover .photo-btns{opacity:1}

    /* add button */
    #addBtn{position:fixed;left:18px;top:18px;z-index:1200;background:var(--panel);border-radius:50%;width:52px;height:52px;border:none;font-size:30px;cursor:pointer;box-shadow:0 8px 25px rgba(0,0,0,0.25)}

    /* popup */
    #popup{display:none;position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);z-index:1400;background:var(--panel);padding:22px;border-radius:16px;box-shadow:0 12px 40px rgba(0,0,0,0.35);width:320px}
    #popup h3{margin:0 0 12px;font-size:18px}
    #popup input[type=file], #popup input[type=text]{width:100%;padding:8px;border-radius:10px;border:1px solid #ddd;margin-top:8px}
    #popup .row{display:flex;gap:8px;margin-top:12px;justify-content:center}
    #popup .row button{flex:1;padding:10px;border-radius:10px;border:none;cursor:pointer}
    #popup .ok{background:var(--accent);color:white}
    #popup .cancel{background:#ccc}

    /* zoom overlay */
    .zoom-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.75);align-items:center;justify-content:center;z-index:2000}
    .zoom-card{position:relative;max-width:92vw;max-height:92vh}
    .zoom-card img{display:block;max-width:100%;max-height:100%;border-radius:14px}
    .zoom-close{position:absolute;top:14px;left:14px;padding:8px 12px;border-radius:10px;border:none;background:#fff;cursor:pointer}

    @media(min-width:900px){.center{padding-top:120px}.logo{width:220px;height:220px}}
  </style>
</head>
<body>
  <div class="center">
    <img class="logo" src="sa_logo.png" alt="logo">
    <div class="label">اضغط على الصورة لتنزيلها</div>
  </div>

  <button id="addBtn" title="أضف صورة">+</button>

  <div class="photo-container" id="photoContainer">
    <!-- الصور ستدخل هنا -->
  </div>

  <!-- نافذة إضافة -->
  <div id="popup" role="dialog" aria-modal="true">
    <h3>إضافة صورة جديدة</h3>
    <input id="uploadImg" type="file" accept="image/*">
    <input id="downloadLink" type="text" placeholder="رابط التنزيل (مثال: https://...)">
    <div class="row">
      <button class="ok" id="saveImg">تم</button>
      <button class="cancel" id="closePopup">إغلاق</button>
    </div>
  </div>

  <!-- تكبير -->
  <div class="zoom-overlay" id="zoomOverlay">
    <div class="zoom-card" id="zoomCard">
      <img id="zoomImg" src="" alt="" />
      <button class="zoom-close" id="zoomClose">تصغير</button>
    </div>
  </div>

  <script>
    // عناصر
    const addBtn = document.getElementById('addBtn');
    const popup = document.getElementById('popup');
    const saveBtn = document.getElementById('saveImg');
    const closePopup = document.getElementById('closePopup');
    const uploadInput = document.getElementById('uploadImg');
    const downloadInput = document.getElementById('downloadLink');
    const container = document.getElementById('photoContainer');
    const zoomOverlay = document.getElementById('zoomOverlay');
    const zoomImg = document.getElementById('zoomImg');
    const zoomClose = document.getElementById('zoomClose');

    // فتح نافذة الإضافة
    addBtn.addEventListener('click', ()=>{ popup.style.display='block'; uploadInput.value=''; downloadInput.value=''; });

    // إغلاق
    closePopup.addEventListener('click', ()=> popup.style.display='none');

    // تحميل من الذاكرة عند الفتح
    function loadSaved(){
      try{
        const saved = JSON.parse(localStorage.getItem('savedPhotos')||'[]');
        saved.forEach(it=>createPhotoElement(it.src,it.link));
      }catch(e){console.error('loadSaved',e)}
    }

    // إنشاء عنصر صورة داخل الصفحة
    function createPhotoElement(src, link){
      const wrap = document.createElement('div'); wrap.className='photo-wrapper';
      const img = document.createElement('img'); img.src=src; img.alt='الصورة';

      // overlay buttons container
      const btns = document.createElement('div'); btns.className='photo-btns';

      const zoomBtn = document.createElement('button'); zoomBtn.className='btn zoom'; zoomBtn.textContent='+';
      zoomBtn.title='تكبير';
      zoomBtn.addEventListener('click', (e)=>{ e.stopPropagation(); openZoom(src); });

      const dlBtn = document.createElement('button'); dlBtn.className='btn dl'; dlBtn.textContent='تحميل';
      dlBtn.title='تحميل';
      dlBtn.addEventListener('click', (e)=>{ e.stopPropagation(); downloadData(src); });

      btns.appendChild(zoomBtn); btns.appendChild(dlBtn);
      wrap.appendChild(img); wrap.appendChild(btns);
      container.appendChild(wrap);

      // جعل الضغط على الصورة يفتح الرابط في نافذة جديدة
      img.addEventListener('click', ()=>{ if(link && link.trim()) window.open(link, '_blank'); });
    }

    // حفظ باستخدام localStorage
    saveBtn.addEventListener('click', ()=>{
      if(!uploadInput.files.length){ alert('اختر صورة أولاً'); return; }
      const link = downloadInput.value.trim();
      if(!link){ alert('ضع رابط التنزيل'); return; }
      const file = uploadInput.files[0];
      const reader = new FileReader();
      reader.onload = ()=>{
        const data = reader.result;
        // حفظ
        const saved = JSON.parse(localStorage.getItem('savedPhotos')||'[]');
        saved.push({src:data, link:link});
        localStorage.setItem('savedPhotos', JSON.stringify(saved));
        createPhotoElement(data, link);
        popup.style.display='none';
      };
      reader.readAsDataURL(file);
    });

    // تنزيل الصورة (للداتا يو آر إل)
    function downloadData(dataUrl){
      try{
        const a = document.createElement('a');
        a.href = dataUrl;
        // محاولة استخلاص اسم ملف
        a.download = 'image.png';
        document.body.appendChild(a);
        a.click();
        a.remove();
      }catch(e){ console.error(e); }
    }

    // فتح التكبير
    function openZoom(src){
      zoomImg.src = src;
      zoomOverlay.style.display = 'flex';
      // أخفي زر الإضافة أثناء التكبير
      addBtn.style.display='none';
    }
    zoomClose.addEventListener('click', closeZoom);
    zoomOverlay.addEventListener('click', (e)=>{ if(e.target===zoomOverlay) closeZoom(); });
    function closeZoom(){ zoomOverlay.style.display='none'; zoomImg.src=''; addBtn.style.display='block'; }

    // تشغيل عند التحميل
    loadSaved();
  </script>
</body>
</html>